<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">


    <bean class="org.jahiacommunity.modules.piwik.action.CustomizePiwikSettingsAction">
        <property name="name" value="customizePiwikSettings" />
        <property name="settingsErrorMessage" value=""/>
    </bean>

    <bean class="org.jahiacommunity.modules.piwik.action.PublishPiwikSettingsAction"  depends-on="piwikCacheService">
        <property name="name" value="publishPiwikSettings" />
        <property name="publicationService" ref="jcrPublicationService" />
    </bean>

    <bean class="org.jahiacommunity.modules.piwik.filter.PiwikTrackingToolFilter"  depends-on="piwikCacheService">
        <property name="priority" value="20" />
        <property name="applyOnConfigurations" value="page" />
        <property name="template" value="${PiwikTrackingToolTemplate:/modules/piwik-matomo/WEB-INF/scripts/PiwikTrackingTool.groovy}"/>
        <property name="scriptEngineUtils" ref="scriptEngineUtils"/>
    </bean>

    <bean id="piwikCacheService" class="org.jahiacommunity.modules.piwik.cache.PiwikCacheService">
        <constructor-arg ref="ehCacheProvider" />
    </bean>

    <!--bean id="contentTrack" class="org.jahiacommunity.modules.piwik.filter.PiwikTrackingContentFilter" depends-on="piwikCacheService">
        <property name="description" value="track content" />
        <property name="priority" value="17" />
        <property name="applyOnNodeTypes" value="jcpwnt:article" />
        <property name="applyOnTemplateTypes" value="html" />
        <property name="applyOnConfigurations" value="module,wrappedcontent" />
        <property name="applyOnModes" value="live" />
    </bean-->

    <bean id="ehCacheProvider" class="org.jahia.services.cache.ehcache.EhCacheProvider"/>

</beans>